{"version":3,"sources":["webpack:///./src/views/UserProfileLikes.vue?d142","webpack:///./src/views/UserProfileLikes.vue?ce87","webpack:///src/views/UserProfileLikes.vue","webpack:///./src/views/UserProfileLikes.vue?1ec9","webpack:///./src/views/UserProfileLikes.vue?35f0"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","User","name","totalTweets","on","afterFormSubmit","afterDeleteFollowMain","afterAddFollowMain","id","likes","length","_v","_e","_l","like","key","data","TweetId","afterClickModal","afterToggleLike","modalContent","changeReplyCount","removeFollowId","addFollowId","afterAddFollow","afterDeleteFollow","staticRenderFns","components","SideNavBar","RecFollowingList","TopNavBar","TweetsCard","TweetererImformation","TwittererNavPills","TweetReplyModal","Spinner","account","avatar","cover","bio","followingsCounts","followersCounts","isLoading","created","fetchUser","userId","fetchLikes","beforeRouteUpdate","next","computed","methods","filter","totalFollowers","isFollowing","totalFollowings","map","Tweet","totalReplies","component"],"mappings":"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","file":"js/chunk-7a4c62ea.fcfc636b.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserProfileLikes.vue?vue&type=style&index=0&id=183fa180&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container main-container\"},[_c('div',{staticClass:\"row\"},[_c('SideNavBar',{staticClass:\"col-3\"}),_c('div',{staticClass:\"col-5 p-0 border main-component\"},[_c('TopNavBar',{attrs:{\"msg\":_vm.User.name,\"show\":true,\"total-tweets\":_vm.User.totalTweets}}),_c('div',{staticClass:\"tweets-container\"},[_c('TweetererImformation',{attrs:{\"initial-user\":_vm.User},on:{\"after-form-submit\":_vm.afterFormSubmit,\"after-delete-follow-main\":_vm.afterDeleteFollowMain,\"after-add-follow-main\":_vm.afterAddFollowMain}}),_c('TwittererNavPills',{attrs:{\"initial-id\":_vm.User.id}}),(_vm.isLoading)?_c('Spinner'):[(_vm.likes.length < 1)?_c('div',{staticClass:\"noTweets\"},[_vm._v(\" 此用戶暫無喜歡的內容 \")]):_vm._e(),_vm._l((_vm.likes),function(like){return _c('TweetsCard',{key:like.id,attrs:{\"initial-data\":like.data,\"reply-tweet\":like.data.TweetId},on:{\"after-click-modal\":_vm.afterClickModal,\"after-toggle-like\":_vm.afterToggleLike}})}),_c('TweetReplyModal',{attrs:{\"target-tweet\":_vm.modalContent},on:{\"change-reply-count\":_vm.changeReplyCount}})]],2)],1),_c('div',{staticClass:\"col-4\"},[_c('RecFollowingList',{attrs:{\"remove-follow-id\":_vm.removeFollowId,\"add-follow-id\":_vm.addFollowId},on:{\"after-add-follow\":_vm.afterAddFollow,\"after-delete-follow\":_vm.afterDeleteFollow}})],1)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"container main-container\">\n    <div class=\"row\">\n      <SideNavBar class=\"col-3\" />\n      <div class=\"col-5 p-0 border main-component\">\n        <TopNavBar \n          :msg=\"User.name\" \n          :show=\"true\" \n          :total-tweets=\"User.totalTweets\" \n        />\n        <div class=\"tweets-container\">\n          <TweetererImformation \n            :initial-user=\"User\"\n            @after-form-submit=\"afterFormSubmit\"\n            @after-delete-follow-main=\"afterDeleteFollowMain\"\n            @after-add-follow-main=\"afterAddFollowMain\"\n          />\n          <TwittererNavPills \n            :initial-id=\"User.id\"\n          />\n          <Spinner v-if=\"isLoading\" />\n          <template v-else>\n            <div class=\"noTweets\" v-if=\"likes.length < 1\">\n              此用戶暫無喜歡的內容\n            </div>\n            <TweetsCard\n              v-for=\"like in likes\"\n              :key=\"like.id\"\n              :initial-data=\"like.data\"\n              :reply-tweet=\"like.data.TweetId\"\n              @after-click-modal=\"afterClickModal\"\n              @after-toggle-like=\"afterToggleLike\"\n            />\n            <TweetReplyModal \n              :target-tweet=\"modalContent\" \n              @change-reply-count=\"changeReplyCount\"\n            />\n          </template>\n        </div>\n      </div>\n      <div class=\"col-4\">\n        <RecFollowingList \n          @after-add-follow=\"afterAddFollow\"\n          @after-delete-follow=\"afterDeleteFollow\"\n          :remove-follow-id=\"removeFollowId\"\n          :add-follow-id=\"addFollowId\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport SideNavBar from \"./../components/SideNavBar.vue\";\nimport RecFollowingList from \"./../components/RecFollowingsList.vue\";\nimport TopNavBar from \"./../components/TopNavBar.vue\";\nimport TweetsCard from \"./../components/TweetsCard.vue\";\nimport TweetererImformation from \"./../components/TwittererInfomation.vue\";\nimport TwittererNavPills from './../components/TwittererNavPills.vue'\nimport TweetReplyModal from \"../components/TweetReplyModal.vue\";\n\nimport { mapState } from 'vuex'\n\nimport usersAPI from './../apis/users'\nimport tweetsAPI from './../apis/tweets'\nimport { Toast } from './../utils/helpers'\nimport Spinner from '../components/Spinner.vue';\n\n\nexport default {\n  name: \"UserProfileLikes\",\n  components: {\n    SideNavBar,\n    RecFollowingList,\n    TopNavBar,\n    TweetsCard,\n    TweetererImformation,\n    TwittererNavPills,\n    TweetReplyModal,\n    Spinner\n  },\n  data() {\n    return {\n      User: {\n        id: -1,\n        name: \"\",\n        account: \"\",\n        avatar: \"\",\n        cover: \"\",\n        bio: \"\",\n        followingsCounts: 0,\n        followersCounts: 0,\n        totalTweets: 0\n      },\n      likes: [],\n      modalContent: {},\n      removeFollowId: 0,\n      addFollowId: 0,\n      isLoading: true\n    };\n  },\n\n  created() {\n    const { id: userId } = this.$route.params\n    this.fetchUser(userId);\n    this.fetchLikes(userId)\n  },\n  beforeRouteUpdate (to ,from, next) {\n    const { id: userId } = to.params\n    this.fetchUser(userId)\n    this.fetchLikes(userId)\n    next()\n  },\n  computed: {\n    ...mapState(['currentUser'])\n  },\n  methods: {\n    async fetchUser(userId) {\n     try {\n       const { data } = await usersAPI.getUser({ userId })\n       const { id, account, name, bio, avatar, cover, totalFollowers, totalFollowings, totalTweets, isFollowing } = data\n       this.User = {\n         ...this.User,\n         id,\n         name,\n         account,\n         avatar,\n         cover,\n         bio,\n         totalFollowers,\n         totalFollowings,\n         totalTweets,\n         isFollowing\n       }\n       this.isLoading = false\n     } catch(error) {\n       this.isLoading = false\n       Toast.fire({\n         icon: 'error',\n         title: '無法取得資料，請稍後再試。'\n       })\n     }\n    },\n    async fetchLikes(userId) {\n      try {\n        const { data } = await tweetsAPI.getUserLikes({ userId })\n        if(data.message === '使用者沒有喜歡的推文或回覆') {\n          this.likes = []\n          return\n        }\n        // 先只抓喜歡的推文\n\n        data.map(like => {\n          // 抓出喜歡的推文\n          if(like.Tweet) {\n            this.likes.push({\n              id: like.id,\n              createdAt:like.createdAt,\n              data: like.Tweet\n            })\n            return\n            // 抓出喜歡的回覆\n          } else if(like.Reply) {\n            this.likes.push({\n              id: like.id,\n              createdAt:like.createdAt,\n              data: like.Reply\n            })\n            return\n          } \n        })\n\n        this.likes.sort((a, b) => {\n          const aDate = new Date(a.createdAt)\n          const bDate = new Date(b.createdAt)\n          return bDate.getTime() - aDate.getTime()\n        })\n      } catch(error) {\n        Toast.fire({\n          icon: 'error',\n          title: '無法取得喜歡的內容，請稍後再試。'\n        })\n      }\n    },\n    async afterFormSubmit() {\n      const { id: userId } = this.$route.params\n      await this.fetchUser(userId);\n      this.likes.map(like => {\n        if(like.Tweet.User.id === this.User.id) {\n          like.Tweet.User = {\n            ...like.User,\n            ...this.User\n          }\n        }\n      })\n    },\n\n    afterClickModal(data) {\n      this.modalContent = {\n        ...this.modalContent,\n        ...data,\n      };\n    },\n    afterToggleLike() {\n      // 只有在我自己的頁面才執行\n      if(this.User.id === this.currentUser.id) {\n        this.likes = this.likes.filter(like => like.data.isLiked === 1)\n      }\n    },\n    afterAddFollow(userId) {\n      // 在我自己以外的別人的主頁時：\n      if(this.User.id === userId) {\n        this.User.totalFollowers += 1\n        this.User.isFollowing = 1\n        return\n      }\n      // 在我自己的主頁時。\n      if(this.currentUser.id === this.User.id) {\n        this.User.totalFollowings += 1\n        return\n      }\n      return\n    },\n    afterAddFollowMain(userId) {\n      this.addFollowId = userId\n    },\n    afterDeleteFollow(userId) {\n      // 當從右側點選的使用者與當前頁面的使用者相同時：\n      if(this.User.id === userId) {\n        this.User.totalFollowers -= 1\n        this.User.isFollowing = 0\n        return\n      }\n      // 在我自己的主頁時。\n      if(this.currentUser.id === this.User.id) {\n        this.User.totalFollowings -= 1\n        return\n      }\n      return\n    },\n    afterDeleteFollowMain(userId) {\n      this.removeFollowId = userId\n    },\n    changeReplyCount(tweetId) {\n      this.likes.map(like => {\n        if(like.Tweet.id === tweetId) {\n          like.Tweet.totalReplies += 1\n        }\n      })\n    }\n  },\n};\n</script>\n\n<style scoped>\n.main-container {\n  height: 100%;\n  position: relative;\n}\n\n.main-component {\n  height: 100%;\n}\n\n.tweets-container {\n  height: calc(100% - 50px);\n  overflow: scroll;\n}\n\n.row {\n  height: 100%;\n}\n\n.noTweets {\n  text-align: center;\n  margin: 50px;\n  font-size: 13px;\n  color: #657786;\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserProfileLikes.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserProfileLikes.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserProfileLikes.vue?vue&type=template&id=183fa180&scoped=true&\"\nimport script from \"./UserProfileLikes.vue?vue&type=script&lang=js&\"\nexport * from \"./UserProfileLikes.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UserProfileLikes.vue?vue&type=style&index=0&id=183fa180&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"183fa180\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}