(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-efe2c6b2"],{"0c8d":function(e,t,a){"use strict";a("34e4")},1397:function(e,t,a){"use strict";a("b7cd")},"236c":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container main-container"},[a("div",{staticClass:"row"},[a("SideNavBar",{staticClass:"col-3"}),a("div",{staticClass:"col-5 p-0 border main-component"},[a("TopNavBar",{attrs:{msg:e.User.name,show:!0,totalTweets:e.User.totalTweets}}),a("div",{staticClass:"tweets-container"},[a("TweetererImformation",{attrs:{"initial-user":e.User},on:{"after-form-submit":e.afterFormSubmit,"after-delete-follow-main":e.afterDeleteFollowMain,"after-add-follow-main":e.afterAddFollowMain}}),a("TwittererNavPills",{attrs:{"initial-id":e.User.id}}),e.isLoading?a("Spinner"):[e.replies.length<1?a("div",{staticClass:"noTweets"},[e._v(" 此用戶暫無推文與回覆 ")]):e._e(),e._l(e.replies,(function(t){return a("TweetandReply",{key:t.id,attrs:{"initial-data":t},on:{"after-click-modal":e.afterClickModal}})})),a("TweetReplyModal",{attrs:{"target-tweet":e.modalContent},on:{"after-create-reply":e.afterCreateReply,"change-reply-count":e.changeReplyCount}})]],2)],1),a("div",{staticClass:"col-4"},[e.isLoading?a("Spinner"):[a("RecFollowingList",{attrs:{"remove-follow-id":e.removeFollowId,"add-follow-id":e.addFollowId},on:{"after-add-follow":e.afterAddFollow,"after-delete-follow":e.afterDeleteFollow}})]],2)],1)])},i=[],r=a("1da1"),n=a("5530"),o=(a("96cf"),a("b0c0"),a("4e82"),a("d81d"),a("56e4")),l=a("f250"),c=a("ab4f"),d=a("1593"),u=a("086c"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tweetReply"},[a("router-link",{staticClass:"tweet-link",attrs:{to:{name:"tweet",params:{id:e.data.id}}}},[a("div",{staticClass:"d-flex"},[a("div",{staticClass:"img-container"},[a("router-link",{attrs:{to:{name:"user-tweets",params:{id:e.data.UserId}}}},[a("img",{attrs:{src:e._f("emptyImage")(e.data.User.avatar),alt:""}})]),a("div",{staticClass:"replyTarget"})],1),a("div",{staticClass:"text-container mt-2 flex-grow-1"},[a("div",{staticClass:"header"},[a("div",{staticClass:"name d-inline-block pe-2"},[e._v(e._s(e.data.User.name))]),a("div",{staticClass:"account d-inline-block"},[e._v(e._s(e.data.User.account))]),a("div",{staticClass:"createdAt d-inline-block"},[e._v(" ・"+e._s(e._f("fromNow")(e.data.createdAt))+" ")])]),a("div",{staticClass:"body mb-3"},[a("div",{staticClass:"text me-3"},[e._v(" "+e._s(e.data.description)+" ")])]),a("div",{staticClass:"footer d-flex my-2"},[a("div",{staticClass:"comment d-flex align-items-center me-5"},[a("div",{staticClass:"btn comment-img",attrs:{"data-bs-toggle":"modal","data-bs-target":"#tweetReplyModal"},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.clickModalButton(e.data)}}}),a("div",{staticClass:"comments-count"},[e._v(e._s(e.data.totalReplies))])]),a("div",{staticClass:"liked d-flex align-items-center",class:{activeLiked:1===e.data.isLiked}},[a("button",{staticClass:"btn liked-img",attrs:{disabled:e.status.isProcessing},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.toggleLiked(e.data.id,"tweet")}}}),a("div",{staticClass:"likes-count"},[e._v(e._s(e.data.totalLikes))])])])])]),e._l(e.data.Replies,(function(t){return a("div",{key:t.id,staticClass:"d-flex reply-card"},[a("div",{staticClass:"img-container"},[a("router-link",{attrs:{to:{name:"user-tweets",params:{id:t.User.id}}}},[a("img",{attrs:{src:e._f("emptyImage")(t.User.avatar),alt:""}})])],1),a("div",{staticClass:"text-container mt-2 flex-grow-1"},[a("div",{staticClass:"header"},[a("div",{staticClass:"name d-inline-block pe-2"},[e._v(e._s(t.User.name))]),a("div",{staticClass:"account d-inline-block"},[e._v(e._s(t.User.account))]),a("div",{staticClass:"createdAt d-inline-block"},[e._v(" ・"+e._s(e._f("fromNow")(t.createdAt))+" ")])]),a("div",{staticClass:"body mb-3"},[a("div",{staticClass:"text me-3"},[e._v(" "+e._s(t.content)+" ")])])]),t.id?a("div",{staticClass:"liked footer align-items-center d-flex my-2",class:{activeLiked:1===t.isLiked}},[a("button",{staticClass:"flex-row btn liked-img",attrs:{disabled:e.status.isProcessing},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),e.toggleLiked(t.id,"reply")}}})]):e._e()])})),a("div",{staticClass:"border-bottom"})],2)],1)},m=[],p=(a("7db0"),a("2708")),w=a("2f62"),v=a("6783"),g=a("2fa3"),b={name:"TweetsCard",mixins:[p["a"],p["b"]],props:{initialData:{type:Object,required:!0}},computed:Object(n["a"])({},Object(w["b"])(["currentUser"])),data:function(){return{data:this.initialData,status:{isProcessing:!1}}},methods:{clickModalButton:function(e){this.$emit("after-click-modal",e)},toggleLiked:function(e,t){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function s(){var i,r,n,o,l,c,d,u,f;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(s.prev=0,a.status.isProcessing=!0,"tweet"!==t){s.next=24;break}if(0!==a.data.isLiked){s.next=15;break}return s.next=6,v["a"].likeTweet({tweetId:e});case 6:if(i=s.sent,r=i.data,"success"===r.status){s.next=10;break}throw new Error(r.message);case 10:a.data.totalLikes+=1,a.data.isLiked=1,g["a"].fire({icon:"success",title:r.message}),s.next=24;break;case 15:return s.next=17,v["a"].unlikeTweet({tweetId:e});case 17:if(n=s.sent,o=n.data,"success"===o.status){s.next=21;break}throw new Error(o.message);case 21:a.data.totalLikes-=1,a.data.isLiked=0,g["a"].fire({icon:"success",title:o.message});case 24:if("reply"!==t){s.next=45;break}if(l=a.data.Replies.find((function(t){return t.id===e})),0!==l.isLiked){s.next=37;break}return s.next=29,v["a"].likeReply({replyId:e});case 29:if(c=s.sent,d=c.data,"success"===d.status){s.next=33;break}throw new Error(d.message);case 33:l.isLiked=1,g["a"].fire({icon:"success",title:d.message}),s.next=45;break;case 37:return s.next=39,v["a"].unlikeReply({replyId:e});case 39:if(u=s.sent,f=u.data,"success"===f.status){s.next=43;break}throw new Error(f.message);case 43:l.isLiked=0,g["a"].fire({icon:"success",title:f.message});case 45:a.status.isProcessing=!1,a.$emit("after-toggle-like"),s.next=53;break;case 49:s.prev=49,s.t0=s["catch"](0),a.status.isProcessing=!1,g["a"].fire({icon:"error",title:s.t0.message});case 53:case"end":return s.stop()}}),s,null,[[0,49]])})))()}}},h=b,k=(a("1397"),a("2877")),C=Object(k["a"])(h,f,m,!1,null,"5b556993",null),U=C.exports,x=a("811a"),R=a("4cce"),y=a("2375"),F={name:"UserProfileReply",components:{SideNavBar:o["a"],RecFollowingList:l["a"],TopNavBar:c["a"],TweetandReply:U,TweetererImformation:d["a"],TwittererNavPills:u["a"],Spinner:y["a"],TweetReplyModal:x["a"]},data:function(){return{User:{id:-1,name:"",account:"",avatar:"",cover:"",bio:"",totalFollowings:0,totalFollowers:0,totalTweets:0,isFollowing:0},replies:[],removeFollowId:0,addFollowId:0,isLoading:!0,modalContent:{}}},created:function(){var e=this.$route.params.id;this.fetchUser(e),this.fetchReplies(e)},beforeRouteUpdate:function(e,t,a){var s=e.params.id;this.fetchUser(s),this.fetchReplies(s),a()},computed:Object(n["a"])({},Object(w["b"])(["currentUser"])),methods:{fetchUser:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var s,i,r,o,l,c,d,u,f,m,p,w;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,R["a"].getUser({userId:e});case 3:s=a.sent,i=s.data,r=i.id,o=i.account,l=i.name,c=i.bio,d=i.avatar,u=i.cover,f=i.totalFollowers,m=i.totalFollowings,p=i.totalTweets,w=i.isFollowing,t.User=Object(n["a"])(Object(n["a"])({},t.User),{},{id:r,name:l,account:o,avatar:d,cover:u,bio:c,totalFollowers:f,totalFollowings:m,totalTweets:p,isFollowing:w}),t.isLoading=!1,a.next=14;break;case 10:a.prev=10,a.t0=a["catch"](0),t.isLoading=!1,g["a"].fire({icon:"error",title:"無法取得資料，請稍後再試。"});case 14:case"end":return a.stop()}}),a,null,[[0,10]])})))()},fetchReplies:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,v["a"].getReply({userId:e});case 3:if(s=a.sent,i=s.data,"使用者沒有回覆任何推文"!==i.message){a.next=8;break}return t.replies=[],a.abrupt("return");case 8:t.replies=i,t.replies.sort((function(e,t){var a=new Date(e.Replies[e.Replies.length-1].createdAt),s=new Date(t.Replies[t.Replies.length-1].createdAt);return s.getTime()-a.getTime()})),t.isLoading=!1,a.next=17;break;case 13:a.prev=13,a.t0=a["catch"](0),t.isLoading=!1,g["a"].fire({icon:"error",title:"目前無法顯示回應，請稍後再試"});case 17:case"end":return a.stop()}}),a,null,[[0,13]])})))()},afterFormSubmit:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.$route.params.id,t.next=3,e.fetchUser(a);case 3:e.replies.map((function(t){t.User.id===a&&(t.User=Object(n["a"])(Object(n["a"])({},t.User),e.User)),t.Replies.map((function(t){t.User.id===a&&(t.User=Object(n["a"])(Object(n["a"])({},t),e.User))}))}));case 4:case"end":return t.stop()}}),t)})))()},afterAddFollow:function(e){if(this.User.id===e)return this.User.totalFollowers+=1,void(this.User.isFollowing=1);this.currentUser.id!==this.User.id||(this.User.totalFollowings+=1)},afterAddFollowMain:function(e){this.addFollowId=e},afterDeleteFollow:function(e){if(this.User.id===e)return this.User.totalFollowers-=1,void(this.User.isFollowing=0);this.currentUser.id!==this.User.id||(this.User.totalFollowings-=1)},afterDeleteFollowMain:function(e){this.removeFollowId=e},afterClickModal:function(e){this.modalContent=Object(n["a"])(Object(n["a"])({},this.modalContent),e)},afterCreateReply:function(e){var t=this,a=e.content,s=e.tweetId;this.User.id===this.currentUser.id&&this.replies.map((function(e){e.id===s&&e.Replies.push({User:t.currentUser,content:a,createdAt:new Date,isLiked:0,totlaLikes:0})}))},changeReplyCount:function(e){this.replies.map((function(t){t.id===e&&(t.totalReplies+=1)}))}}},_=F,L=(a("0c8d"),Object(k["a"])(_,s,i,!1,null,"1911b85d",null));t["default"]=L.exports},"34e4":function(e,t,a){},"7db0":function(e,t,a){"use strict";var s=a("23e7"),i=a("b727").find,r=a("44d2"),n="find",o=!0;n in[]&&Array(1)[n]((function(){o=!1})),s({target:"Array",proto:!0,forced:o},{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(n)},b7cd:function(e,t,a){}}]);
//# sourceMappingURL=chunk-efe2c6b2.2c521de0.js.map