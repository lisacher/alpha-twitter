(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-695ac44c"],{"3ac3":function(t,e,a){},"43d3":function(t,e,a){"use strict";a("3ac3")},b8d0:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container main-container"},[a("div",{staticClass:"row"},[a("SideNavBar",{staticClass:"col-3",attrs:{isAdmin:!0}}),a("div",{staticClass:"col-9 p-0 border main-component"},[a("TopNavBar",{attrs:{msg:"推文清單",show:!1}}),a("div",{staticClass:"tweets-container"},[t.isLoading?a("Spinner"):[t._l(t.tweets,(function(e){return a("AdminTweetsCard",{key:e.id,attrs:{tweet:e},on:{"after-generate-target":t.afterGenerateTarget}})})),a("div",{staticClass:"modal fade",attrs:{id:"deleteModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("div",[t._v("您確定要刪除此則推文嗎？")]),a("button",{staticClass:"btn-close",attrs:{type:"button","data-bs-dismiss":"modal","aria-label":"Close"}})]),a("div",{staticClass:"modal-body text-center"},[t._v("推文刪除後將無法復原")]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-bs-dismiss":"modal"}},[t._v(" 取消 ")]),a("button",{staticClass:"btn btn-danger",attrs:{type:"button","data-bs-toggle":"modal","data-bs-target":"#deleteModal"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteTweet(t.deleteTargetId)}}},[t._v(" 確定 ")])])])])])]],2)],1)],1)])},n=[],r=a("1da1"),i=(a("96cf"),a("4e82"),a("4de4"),a("56e4")),c=a("ab4f"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"d-flex border tweet-container px-2"},[a("div",{staticClass:"img-container"},[a("img",{attrs:{src:t._f("emptyImage")(t.tweet.User.avatar),alt:""}})]),a("div",{staticClass:"text-container mt-2 flex-grow-1"},[a("div",{staticClass:"header"},[a("div",{staticClass:"name d-inline-block pe-2 fw-bold"},[t._v(" "+t._s(t.tweet.User.name)+" ")]),a("div",{staticClass:"account d-inline-block"},[t._v(t._s(t.tweet.User.account))]),a("div",{staticClass:"createdAt d-inline-block"},[t._v(" ・"+t._s(t._f("fromNow")(t.tweet.createdAt))+" ")])]),a("div",{staticClass:"body"},[a("div",{staticClass:"text"},[t._v(" "+t._s(t._f("textEllipsis")(t.tweet.description))+" ")])])]),a("div",{staticClass:"delete-container"},[a("button",{staticClass:"btn btn-close mt-2",attrs:{type:"button","data-bs-toggle":"modal","data-bs-target":"#deleteModal"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.generatedeleteTarger(t.tweet.id)}}})])])])},o=[],l=a("2708"),u={name:"AdminTweetsCard",mixins:[l["a"],l["b"]],props:{tweet:{type:Object,required:!0}},methods:{generatedeleteTarger:function(t){this.$emit("after-generate-target",{tweetId:t})}},filters:{textEllipsis:function(t){var e=50;return t.length<=e?t:t.substring(0,e)+"..."}}},v=u,f=(a("43d3"),a("2877")),b=Object(f["a"])(v,d,o,!1,null,"525b750a",null),m=b.exports,w=a("6783"),p=a("2fa3"),g=a("2375"),C={name:"AdminTweetsList",components:{SideNavBar:i["a"],TopNavBar:c["a"],AdminTweetsCard:m,Spinner:g["a"]},data:function(){return{tweets:[],deleteTargetId:0,isLoading:!0}},created:function(){this.fetchTweets()},methods:{fetchTweets:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w["a"].getAdminTweets();case 3:a=e.sent,s=a.data,t.tweets=s,t.tweets.sort((function(t,e){var a=new Date(t.createdAt),s=new Date(e.createdAt);return s.getTime()-a.getTime()})),t.isLoading=!1,e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](0),t.isLoading=!1,p["a"].fire({icon:"error",title:"無法取得推文資料，請稍後再試"});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))()},afterGenerateTarget:function(t){var e=t.tweetId;this.deleteTargetId=e},deleteTweet:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var s,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,w["a"].deleteTweet({tweetId:t});case 3:if(s=a.sent,n=s.data,"error"!==n.status){a.next=7;break}throw new Error(n.message);case 7:e.tweets=e.tweets.filter((function(t){return t.id!==e.deleteTargetId})),p["a"].fire({icon:"success",title:"成功刪除推文！"}),a.next=14;break;case 11:a.prev=11,a.t0=a["catch"](0),p["a"].fire({icon:"error",title:"目前無法刪除貼文，請稍後再試"});case 14:case"end":return a.stop()}}),a,null,[[0,11]])})))()}}},h=C,T=(a("ee01"),Object(f["a"])(h,s,n,!1,null,"99021bba",null));e["default"]=T.exports},c1cd:function(t,e,a){},ee01:function(t,e,a){"use strict";a("c1cd")}}]);
//# sourceMappingURL=chunk-695ac44c.7fc7a22e.js.map