{"version":3,"sources":["webpack:///./src/views/UserProfileTweets.vue?af9f","webpack:///src/views/UserProfileTweets.vue","webpack:///./src/views/UserProfileTweets.vue?46d7","webpack:///./src/views/UserProfileTweets.vue?057e","webpack:///./src/views/UserProfileTweets.vue?7c2e"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","afterCreateTweet","attrs","User","name","totalTweets","afterFormSubmit","afterDeleteFollowMain","afterAddFollowMain","id","tweets","length","_v","_e","_l","tweet","key","afterClickModal","modalContent","changeReplyCount","removeFollowId","addFollowId","afterAddFollow","afterDeleteFollow","staticRenderFns","components","SideNavBar","RecFollowingList","TopNavBar","TweetsCard","TweetererImformation","TwittererNavPills","TweetReplyModal","Spinner","data","account","avatar","cover","bio","totalFollowings","totalFollowers","isFollowing","isLoading","created","fetchUser","userId","fetchUserTweet","beforeRouteUpdate","next","computed","methods","unshift","currentUser","description","createdAt","Date","isLiked","totalLikes","totalReplies","map","component"],"mappings":"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","file":"js/chunk-7479dd90.e6f661f3.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container main-container\"},[_c('div',{staticClass:\"row\"},[_c('SideNavBar',{staticClass:\"col-3\",on:{\"after-create-tweet\":_vm.afterCreateTweet}}),_c('div',{staticClass:\"col-5 p-0 border main-component\"},[_c('TopNavBar',{attrs:{\"msg\":_vm.User.name,\"show\":true,\"total-tweets\":_vm.User.totalTweets}}),_c('div',{staticClass:\"tweets-container\"},[_c('TweetererImformation',{attrs:{\"initial-user\":_vm.User},on:{\"after-form-submit\":_vm.afterFormSubmit,\"after-delete-follow-main\":_vm.afterDeleteFollowMain,\"after-add-follow-main\":_vm.afterAddFollowMain}}),_c('TwittererNavPills',{attrs:{\"initial-id\":_vm.User.id}}),(_vm.isLoading)?_c('Spinner'):[(_vm.tweets.length < 1)?_c('div',{staticClass:\"noTweets\"},[_vm._v(\" 此用戶暫無推文 \")]):_vm._e(),_vm._l((_vm.tweets),function(tweet){return _c('TweetsCard',{key:tweet.id,attrs:{\"initial-data\":tweet},on:{\"after-click-modal\":_vm.afterClickModal}})}),_c('TweetReplyModal',{attrs:{\"target-tweet\":_vm.modalContent},on:{\"change-reply-count\":_vm.changeReplyCount}})]],2)],1),_c('div',{staticClass:\"col-4\"},[_c('RecFollowingList',{attrs:{\"remove-follow-id\":_vm.removeFollowId,\"add-follow-id\":_vm.addFollowId},on:{\"after-add-follow\":_vm.afterAddFollow,\"after-delete-follow\":_vm.afterDeleteFollow}})],1)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"container main-container\">\n    <div class=\"row\">\n      <SideNavBar \n        class=\"col-3\" \n        @after-create-tweet=\"afterCreateTweet\"\n      />\n      <div class=\"col-5 p-0 border main-component\">\n        <TopNavBar \n          :msg=\"User.name\" \n          :show=\"true\" \n          :total-tweets=\"User.totalTweets\" \n        />\n        <div class=\"tweets-container\">\n          <TweetererImformation \n            :initial-user=\"User\"\n            @after-form-submit=\"afterFormSubmit\"\n            @after-delete-follow-main=\"afterDeleteFollowMain\"\n            @after-add-follow-main=\"afterAddFollowMain\"\n          />\n          <TwittererNavPills \n            :initial-id=\"User.id\"\n          />\n          <Spinner v-if=\"isLoading\" />\n          <template v-else>\n          <div class=\"noTweets\" v-if=\"tweets.length < 1\">\n            此用戶暫無推文\n          </div>  \n          <TweetsCard\n            v-for=\"tweet in tweets\"\n            :key=\"tweet.id\"\n            :initial-data=\"tweet\"\n            @after-click-modal=\"afterClickModal\"\n          />\n          <TweetReplyModal \n            :target-tweet=\"modalContent\" \n            @change-reply-count=\"changeReplyCount\"\n          />\n          </template>\n        </div>\n      </div>\n      <div class=\"col-4\">\n        <RecFollowingList \n          @after-add-follow=\"afterAddFollow\"\n          @after-delete-follow=\"afterDeleteFollow\"\n          :remove-follow-id=\"removeFollowId\"\n          :add-follow-id=\"addFollowId\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n// import component \nimport SideNavBar from \"./../components/SideNavBar.vue\";\nimport RecFollowingList from \"./../components/RecFollowingsList.vue\";\nimport TopNavBar from \"./../components/TopNavBar.vue\";\nimport TweetsCard from \"./../components/TweetsCard.vue\";\nimport TweetererImformation from \"./../components/TwittererInfomation.vue\";\nimport TwittererNavPills from './../components/TwittererNavPills.vue'\nimport TweetReplyModal from \"../components/TweetReplyModal.vue\";\n\n// import currentUser\nimport { mapState } from 'vuex'\n\n// import API\nimport usersAPI from './../apis/users'\nimport tweetsAPI from './../apis/tweets'\nimport { Toast } from './../utils/helpers'\nimport Spinner from '../components/Spinner.vue';\n\n\nexport default {\n  name: \"UserProfileTweets\",\n  components: {\n    SideNavBar,\n    RecFollowingList,\n    TopNavBar,\n    TweetsCard,\n    TweetererImformation,\n    TwittererNavPills,\n    TweetReplyModal,\n    Spinner\n  },\n  data() {\n    return {\n      User: {\n        id: -1,\n        name: \"\",\n        account: \"\",\n        avatar: \"\",\n        cover: \"\",\n        bio: \"\",\n        totalFollowings: 0,\n        totalFollowers: 0,\n        totalTweets: 0,\n        isFollowing: 0\n      },\n      tweets: [],\n      modalContent : {},\n      removeFollowId: 0,\n      addFollowId: 0,\n      isLoading: true\n    };\n  },\n\n  created() {\n    const { id: userId } = this.$route.params\n    this.fetchUser(userId);\n    this.fetchUserTweet(userId)\n  },\n  beforeRouteUpdate (to ,from, next) {\n    const { id: userId } = to.params\n    this.fetchUser(userId)\n    this.fetchUserTweet(userId)\n    next()\n  },\n  computed: {\n    ...mapState(['currentUser'])\n  },\n  methods: {\n   async fetchUser(userId) {\n     try {\n       const { data } = await usersAPI.getUser({ userId })\n       \n       const { id, account, name, bio, avatar, cover, totalFollowers, totalFollowings, totalTweets, isFollowing } = data\n       this.User = {\n         ...this.User,\n         id,\n         name,\n         account,\n         avatar,\n         cover,\n         bio,\n         totalFollowers,\n         totalFollowings,\n         totalTweets,\n         isFollowing\n       }\n       this.isLoading = false\n     } catch(error) {\n       this.isLoading = false\n       Toast.fire({\n         icon: 'error',\n         title: '無法取得資料，請稍後再試。'\n       })\n     }\n    },\n    async fetchUserTweet(userId) {\n      try{\n        const { data } = await tweetsAPI.getUsersTweets({ userId })\n        //如果使用者沒有任何推文：\n       if(data.message === '使用者暫無推文') {\n         this.tweets = []\n         return\n       }\n        this.tweets = data\n\n        // 排序\n        this.tweets.sort((a, b) => {\n          const aDate = new Date(a.createdAt)\n          const bDate = new Date(b.createdAt)\n          return bDate.getTime() - aDate.getTime()\n        })\n\n      } catch(error) {\n        Toast.fire({\n          icon: 'error',\n          title: '目前無法取得資料，請稍後再試'\n        })\n      }\n    },\n    afterCreateTweet({ description, id }) {\n      if(this.User.id !== this.currentUser.id) {\n        return\n      }\n      this.tweets.unshift({\n        id,\n        User: {\n          id: this.currentUser.id,\n          name: this.currentUser.name,\n          account: this.currentUser.account,\n          avatar: this.currentUser.avatar\n\n        },\n        description,\n        createdAt: new Date(),\n        isLiked: false,\n        totalLikes: 0,\n        totalReplies: 0\n      })\n    },\n    async afterFormSubmit() {\n      const { id: userId } = this.$route.params\n      await this.fetchUser(userId);\n      this.tweets.map(tweet => {\n        tweet.User = {\n          ...tweet.User,\n          ...this.User\n        }\n      })\n    },\n    afterClickModal(data) {\n      this.modalContent = {\n        ...this.modalContent,\n        ...data,\n      };\n    },\n    afterAddFollow(userId) {\n      // 在我自己以外的別人的主頁時：\n      if(this.User.id === userId) {\n        this.User.totalFollowers += 1\n        this.User.isFollowing = 1\n        return\n      }\n      // 在我自己的主頁時。\n      if(this.currentUser.id === this.User.id) {\n        this.User.totalFollowings += 1\n        return\n      }\n      return\n    },\n    afterAddFollowMain(userId) {\n      this.addFollowId = userId\n    },\n    afterDeleteFollow(userId) {\n      // 當從右側點選的使用者與當前頁面的使用者相同時：\n      if(this.User.id === userId) {\n        this.User.totalFollowers -= 1\n        this.User.isFollowing = 0\n        return\n      }\n      // 在我自己的主頁時。\n      if(this.currentUser.id === this.User.id) {\n        this.User.totalFollowings -= 1\n        return\n      }\n      return\n    },\n    afterDeleteFollowMain(userId) {\n      this.removeFollowId = userId\n    },\n    changeReplyCount(tweetId) {\n      this.tweets.map(tweet => {\n        if(tweet.id === tweetId) {\n          tweet.totalReplies += 1\n        }\n      })\n    }\n  },\n};\n</script>\n\n<style scoped>\n.main-container {\n  height: 100%;\n}\n\n.main-component {\n  height: 100%;\n}\n\n.tweets-container {\n  height: calc(100% - 50px);\n  overflow: scroll;\n}\n\n.row {\n  height: 100%;\n}\n\n.noTweets {\n  text-align: center;\n  margin: 50px;\n  font-size: 13px;\n  color: #657786;\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserProfileTweets.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserProfileTweets.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserProfileTweets.vue?vue&type=template&id=4f929341&scoped=true&\"\nimport script from \"./UserProfileTweets.vue?vue&type=script&lang=js&\"\nexport * from \"./UserProfileTweets.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UserProfileTweets.vue?vue&type=style&index=0&id=4f929341&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4f929341\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserProfileTweets.vue?vue&type=style&index=0&id=4f929341&scoped=true&lang=css&\""],"sourceRoot":""}