(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7479dd90"],{"5a38":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container main-container"},[r("div",{staticClass:"row"},[r("SideNavBar",{staticClass:"col-3",on:{"after-create-tweet":e.afterCreateTweet}}),r("div",{staticClass:"col-5 p-0 border main-component"},[r("TopNavBar",{attrs:{msg:e.User.name,show:!0,"total-tweets":e.User.totalTweets}}),r("div",{staticClass:"tweets-container"},[r("TweetererImformation",{attrs:{"initial-user":e.User},on:{"after-form-submit":e.afterFormSubmit,"after-delete-follow-main":e.afterDeleteFollowMain,"after-add-follow-main":e.afterAddFollowMain}}),r("TwittererNavPills",{attrs:{"initial-id":e.User.id}}),e.isLoading?r("Spinner"):[e.tweets.length<1?r("div",{staticClass:"noTweets"},[e._v(" 此用戶暫無推文 ")]):e._e(),e._l(e.tweets,(function(t){return r("TweetsCard",{key:t.id,attrs:{"initial-data":t},on:{"after-click-modal":e.afterClickModal}})})),r("TweetReplyModal",{attrs:{"target-tweet":e.modalContent},on:{"change-reply-count":e.changeReplyCount}})]],2)],1),r("div",{staticClass:"col-4"},[r("RecFollowingList",{attrs:{"remove-follow-id":e.removeFollowId,"add-follow-id":e.addFollowId},on:{"after-add-follow":e.afterAddFollow,"after-delete-follow":e.afterDeleteFollow}})],1)],1)])},o=[],i=r("1da1"),n=r("5530"),s=(r("96cf"),r("b0c0"),r("4e82"),r("a4d3"),r("e01a"),r("d81d"),r("56e4")),l=r("f250"),c=r("ab4f"),d=r("58aa"),u=r("1593"),w=r("086c"),f=r("811a"),h=r("2f62"),m=r("4cce"),v=r("6783"),p=r("2fa3"),U=r("2375"),g={name:"UserProfileTweets",components:{SideNavBar:s["a"],RecFollowingList:l["a"],TopNavBar:c["a"],TweetsCard:d["a"],TweetererImformation:u["a"],TwittererNavPills:w["a"],TweetReplyModal:f["a"],Spinner:U["a"]},data:function(){return{User:{id:-1,name:"",account:"",avatar:"",cover:"",bio:"",totalFollowings:0,totalFollowers:0,totalTweets:0,isFollowing:0},tweets:[],modalContent:{},removeFollowId:0,addFollowId:0,isLoading:!0}},created:function(){var e=this.$route.params.id;this.fetchUser(e),this.fetchUserTweet(e)},beforeRouteUpdate:function(e,t,r){var a=e.params.id;this.fetchUser(a),this.fetchUserTweet(a),r()},computed:Object(n["a"])({},Object(h["b"])(["currentUser"])),methods:{fetchUser:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,o,i,s,l,c,d,u,w,f,h,v;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,m["a"].getUser({userId:e});case 3:a=r.sent,o=a.data,i=o.id,s=o.account,l=o.name,c=o.bio,d=o.avatar,u=o.cover,w=o.totalFollowers,f=o.totalFollowings,h=o.totalTweets,v=o.isFollowing,t.User=Object(n["a"])(Object(n["a"])({},t.User),{},{id:i,name:l,account:s,avatar:d,cover:u,bio:c,totalFollowers:w,totalFollowings:f,totalTweets:h,isFollowing:v}),t.isLoading=!1,r.next=14;break;case 10:r.prev=10,r.t0=r["catch"](0),t.isLoading=!1,p["a"].fire({icon:"error",title:"無法取得資料，請稍後再試。"});case 14:case"end":return r.stop()}}),r,null,[[0,10]])})))()},fetchUserTweet:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,v["a"].getUsersTweets({userId:e});case 3:if(a=r.sent,o=a.data,"使用者暫無推文"!==o.message){r.next=8;break}return t.tweets=[],r.abrupt("return");case 8:t.tweets=o,t.tweets.sort((function(e,t){var r=new Date(e.createdAt),a=new Date(t.createdAt);return a.getTime()-r.getTime()})),r.next=15;break;case 12:r.prev=12,r.t0=r["catch"](0),p["a"].fire({icon:"error",title:"目前無法取得資料，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,12]])})))()},afterCreateTweet:function(e){var t=e.description,r=e.id;this.User.id===this.currentUser.id&&this.tweets.unshift({id:r,User:{id:this.currentUser.id,name:this.currentUser.name,account:this.currentUser.account,avatar:this.currentUser.avatar},description:t,createdAt:new Date,isLiked:!1,totalLikes:0,totalReplies:0})},afterFormSubmit:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.$route.params.id,t.next=3,e.fetchUser(r);case 3:e.tweets.map((function(t){t.User=Object(n["a"])(Object(n["a"])({},t.User),e.User)}));case 4:case"end":return t.stop()}}),t)})))()},afterClickModal:function(e){this.modalContent=Object(n["a"])(Object(n["a"])({},this.modalContent),e)},afterAddFollow:function(e){if(this.User.id===e)return this.User.totalFollowers+=1,void(this.User.isFollowing=1);this.currentUser.id!==this.User.id||(this.User.totalFollowings+=1)},afterAddFollowMain:function(e){this.addFollowId=e},afterDeleteFollow:function(e){if(this.User.id===e)return this.User.totalFollowers-=1,void(this.User.isFollowing=0);this.currentUser.id!==this.User.id||(this.User.totalFollowings-=1)},afterDeleteFollowMain:function(e){this.removeFollowId=e},changeReplyCount:function(e){this.tweets.map((function(t){t.id===e&&(t.totalReplies+=1)}))}}},F=g,b=(r("e0a5"),r("2877")),T=Object(b["a"])(F,a,o,!1,null,"4f929341",null);t["default"]=T.exports},dd21:function(e,t,r){},e0a5:function(e,t,r){"use strict";r("dd21")}}]);
//# sourceMappingURL=chunk-7479dd90.e6f661f3.js.map